stages:
    - build
    - review

build:node-6:
    image: node:6
    stage: build
    cache:
        paths:
            - node_modules/
    script:
        - npm update
        - ./node_modules/.bin/gulp init
        - ./node_modules/.bin/gulp build

build:node-7:
    image: node:7
    stage: build
    cache:
        paths:
            - node_modules/
    script:
        - npm update
        - ./node_modules/.bin/gulp init
        - ./node_modules/.bin/gulp build

sonar:
    image: maxwellewxam/sonar-scanner
    stage: review
    script: sonar-scanner -D sonar.host.url=http://sonar.flow.local:80 -D sonar.branch=$CI_BUILD_REF_NAME -D sonar.login=$SONAR_TOKEN
